<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <link rel="stylesheet" href="./details/leaflet_heatmap_files/example-commons.css">
  <link rel="stylesheet" href="./details/leaflet_heatmap_files/leaflet.css">
  <script src="./details/leaflet_heatmap_files/leaflet.js"></script>

</head>
<body class="">
  <div class="wrapper">
    <div class="demo-wrapper">
      <div class="heatmap leaflet-container leaflet-fade-anim" id="map-canvas" style="position: relative;" tabindex="0">
      </div>
    </div>
  </div>
  <script src="./details/leaflet_heatmap_files/heatmap.js"></script>
  <script src="./details/leaflet_heatmap_files/leaflet-heatmap.js"></script>
  <script>

    function movePoint(a, b, distance)
    {
      var vector = [(b[0] - a[0]), (b[1] - a[1])];
      var length = Math.sqrt(vector[0] * vector[0] + vector[1] * vector[1]);
      var unitVector = [(vector[0] / length), (vector[1] / length)];
      return [(a[0] + unitVector[0] * distance), (a[1] + unitVector[1] * distance)];
    };

    window.onload = function() {
        var baseLayer = L.tileLayer(
          'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',{
            maxZoom: 18
          }
        );

        var cfg = {
          "radius": 2,
          "maxOpacity": .8,
          "scaleRadius": true,
          "useLocalExtrema": true,
          latField: 'lat',
          lngField: 'lng',
          valueField: 'count'
        };

        var heatmapLayer = new HeatmapOverlay(cfg);

        var map = new L.Map('map-canvas', {
          center: new L.LatLng(0, 0),
          zoom: 3,
          layers: [baseLayer, heatmapLayer]
        });


        /*-*/startPoint = [{lat: 35.8278, lng:-78.6421, count: 1}, {lat: 46.90, lng:-117.46, count: 1}, {lat: 46.80, lng:-117.3, count: 1}];/*-*/

        var testData = {
            max: 99,
            data: startPoint
          };
        heatmapLayer.setData(testData);

        /*_*/endPoint = [{lat: 46.90, lng:-117.46, count: 1}, null, null];/*_*/

        setTimeout(function() {
          var refreshIntervalId = setInterval(function() {

            var newData = [];

            for (var i = 0; i < startPoint.length; i++)
            {
              if (endPoint[i] != null)
              {
                if (Math.trunc(startPoint[i]['lat']) == Math.trunc(endPoint[i]['lat']) && Math.trunc(startPoint[i]['lng']) == Math.trunc(endPoint[i]['lng']))
                {
                  newData.push({lat: startPoint[i]['lat'], lng:startPoint[i]['lng'], count: 1});
                }
                else
                {
                  newVal = movePoint([startPoint[i]['lat'],startPoint[i]['lng']], [endPoint[i]['lat'],endPoint[i]['lng']], 1);
                  newData.push({lat: newVal[0], lng:newVal[1], count: 1});
                  startPoint[i]['lat'] = newVal[0];
                  startPoint[i]['lng'] = newVal[1];
                }
              }
              else
              {
                newData.push({lat: startPoint[i]['lat'], lng:startPoint[i]['lng'] , count: 1});
              }
            }


            var testData = {
                max: 99,
                data: newData
              };
            heatmapLayer.setData(testData);

          }, 10);
        }, 1000);
    };

  </script>

</body></html>